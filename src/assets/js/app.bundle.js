!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=1500,this.height=2e3,this.isStreaming=!1,this.videoWidth=0,this.videoHeight=0,this.drawWidth=0,this.drawHeight=0,this.drawStartX=0,this.drawStartY=0,this.$startButton=document.querySelector(".js-button-camera-start"),this.$stopButton=document.querySelector(".js-button-camera-stop"),this.$captureButton=document.querySelector(".js-button-camera-capture"),this.$capture=document.querySelector(".capture"),this.$video=document.getElementById("video"),this.$canvas=document.getElementById("canvas"),this.context=this.$canvas.getContext("2d"),this.bind(),this.setup()}return i(t,[{key:"bind",value:function(){var t=this;this.$video.addEventListener("canplay",function(){t.isStreaming||(t.$video.setAttribute("width",t.width),t.$video.setAttribute("height",t.height),t.$canvas.setAttribute("width",t.width),t.$canvas.setAttribute("height",t.height),t.isStreaming=!0)}),this.$captureButton.addEventListener("click",function(){t.takeCaptureImage()})}},{key:"setup",value:function(){var t=this;navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:1920,height:1080},audio:!1}).then(function(e){t.$startButton.addEventListener("click",function(){t.$video.srcObject=e,t.$video.onloadedmetadata=function(){t.fit(),t.renderingToCanvas()}}),t.$stopButton.addEventListener("click",function(){t.$video.srcObject=null})}).catch(function(t){console.log("ERROR : "+t)})}},{key:"fit",value:function(){this.$canvas.style.width="100vw",this.$canvas.width=this.width,this.$canvas.height=this.height,this.videoWidth=this.$video.videoWidth,this.videoHeight=this.$video.videoHeight,this.videoWidth/this.videoHeight>this.width/this.height?(this.drawHeight=this.height,this.drawWidth=this.height/this.videoHeight*this.videoWidth):(this.drawWidth=this.width,this.drawHeight=this.width/this.videoWidth*this.videoHeight),this.drawStartX=(this.width-this.drawWidth)/2,this.drawStartY=(this.height-this.drawHeight)/2,console.log(this.videoWidth,this.videoHeight),console.log(this.drawStartX,this.drawStartY,this.drawWidth,this.drawHeight)}},{key:"renderingToCanvas",value:function(){window.requestAnimationFrame.call(window,this.renderingToCanvas.bind(this)),this.context.clearRect(0,0,this.width,this.height),this.context.drawImage(this.$video,this.drawStartX,this.drawStartY,this.drawWidth,this.drawHeight)}},{key:"takeCaptureImage",value:function(){var t=this.$canvas.toDataURL();this.$capture.setAttribute("src",t)}}]),t}())}]);